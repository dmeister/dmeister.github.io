<!-- Chroma syntax highlighting -->
<link rel="stylesheet" href="/chroma.css">

<!-- Fix code block display -->
<style>
.highlight pre code span {
    display: inline !important;
}
.highlight pre code {
    display: block !important;
}
</style>

{{- if or .Params.mermaid (strings.Contains .Content "class=\"language-mermaid\"") }}
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
  mermaid.initialize({
    startOnLoad: true,
    theme: document.body.className.includes("dark") ? 'dark' : 'default'
  });

  // Re-initialize mermaid on theme change
  const observer = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if (mutation.attributeName === 'class') {
        mermaid.initialize({
          startOnLoad: true,
          theme: document.body.className.includes("dark") ? 'dark' : 'default'
        });
        mermaid.contentLoaded();
      }
    });
  });
  observer.observe(document.body, { attributes: true });
</script>
{{- end }}
